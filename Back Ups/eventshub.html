<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>LILAC Events & Activities</title>
<link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<link rel="icon" href="assets/images/cpu-logo.svg.png">
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": {
                            DEFAULT: "#137fec",
                            "50": "#e8f2fe",
                            "100": "#d1e6fd",
                            "200": "#a2cbfb",
                            "300": "#74b1f9",
                            "400": "#4596f7",
                            "500": "#137fec",
                            "600": "#0f66bc",
                            "700": "#0c4c8d",
                            "800": "#08335d",
                            "900": "#04192e"
                        },
                        "background-light": "#f1f5f9",
                        "background-dark": "#0f172a",
                        "card-light": "#ffffff",
                        "card-dark": "#1e293b",
                        "text-light": "#0f172a",
                        "text-dark": "#e2e8f0",
                        "text-muted-light": "#64748b",
                        "text-muted-dark": "#94a3b8",
                        "border-light": "#e2e8f0",
                        "border-dark": "#334155",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "0.75rem",
                        "xl": "1rem",
                        "full": "9999px"
                    },
                    boxShadow: {
                        'soft': '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -2px rgba(0, 0, 0, 0.05)',
                    }
                },
            },
        }
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .material-symbols-outlined.filled {
            font-variation-settings: 'FILL' 1;
        }
        .dark .chartjs-grid-color {
            color: theme('colors.border-dark');
        }
        .chartjs-grid-color {
            color: theme('colors.border-light');
        }
        .dark .chartjs-tick-color {
            color: theme('colors.text-muted-dark');
        }
        .chartjs-tick-color {
            color: theme('colors.text-muted-light');
        }
        .dark .chartjs-legend-color {
            color: theme('colors.text-dark');
        }
        .chartjs-legend-color {
            color: theme('colors.text-light');
        }
        .sidebar-collapsed .sidebar-text {
            display: none;
        }
        .sidebar-collapsed .sidebar-logo-text {
            display: none;
        }
        .sidebar-collapsed .sidebar {
            width: 5rem;
        }
        .sidebar-expanded .sidebar {
            width: 16rem;
        }
        .sidebar-collapsed .sidebar-profile-info {
            display: none;
        }
        .sidebar-collapsed .sidebar-profile-picture {
            display: none;
        }
        /* Add styles for expanded sidebar */
        .sidebar-expanded .sidebar-profile-picture {
            display: block;
        }
        .sidebar-expanded .sidebar-profile-info {
            display: block;
        }
        .sidebar-collapsed main {
            margin-left: 2rem;
        }
        .sidebar-expanded main {
            margin-left: 0 !important;
        }
        .sidebar-expanded .main-content {
            padding-left: 2rem;
        }
        .sidebar-collapsed .main-content {
            padding-left: 2rem;
        }
        .sidebar-collapsed .sidebar-toggle-icon-open {
            display: none;
        }
        .sidebar-collapsed .sidebar-toggle-icon-closed {
            display: block;
        }
        .sidebar-toggle-icon-closed {
            display: none;
        }
        .sidebar-collapsed .sidebar-nav-link {
            justify-content: center;
        }
        .sidebar-collapsed .sidebar-toggle-container {
            justify-content: center;
        }
        .sidebar-collapsed .profile-container {
            justify-content: center;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-light dark:text-text-dark">
<div class="flex h-screen sidebar-collapsed" id="app-container">
<aside class="sidebar bg-card-light dark:bg-card-dark border-r border-border-light dark:border-border-dark flex flex-col">
<div class="flex items-center justify-start px-4 h-20 border-b border-border-light dark:border-border-dark">
<div class="flex items-center gap-3">
<img alt="CPU LILAC Logo" class="h-11 w-11" src="assets/images/cpu-logo.svg.png" width="32" height="32"/>
<h1 class="text-xl font-bold text-text-light dark:text-text-dark sidebar-logo-text hidden">LILAC</h1>
</div>
</div>
<nav class="flex-1 px-4 py-6 space-y-2">
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-background-dark hover:text-text-light dark:hover:text-text-dark transition-colors duration-200 sidebar-nav-link" href="dashboard.html">
<span class="material-symbols-outlined">dashboard</span>
<span class="sidebar-text hidden">Dashboard</span>
</a>
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-background-dark hover:text-text-light dark:hover:text-text-dark transition-colors duration-200 sidebar-nav-link" href="awards.html">
<span class="material-symbols-outlined">emoji_events</span>
<span class="sidebar-text hidden">Awards Progress</span>
</a>
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg bg-primary-50 dark:bg-primary-900/40 text-primary-600 dark:text-primary-300 font-semibold sidebar-nav-link" href="events-activities.html">
<span class="material-symbols-outlined filled">event</span>
<span class="sidebar-text hidden">Events & Activities</span>
</a>
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-background-dark hover:text-text-light dark:hover:text-text-dark transition-colors duration-200 sidebar-nav-link" href="scheduler.html">
<span class="material-symbols-outlined">calendar_today</span>
<span class="sidebar-text hidden">Scheduler</span>
</a>
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-background-dark hover:text-text-light dark:hover:text-text-dark transition-colors duration-200 sidebar-nav-link" href="mou-moa.html">
<span class="material-symbols-outlined">handshake</span>
<span class="sidebar-text hidden">MOUs &amp; MOAs</span>
</a>
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-background-dark hover:text-text-light dark:hover:text-text-dark transition-colors duration-200 sidebar-nav-link" href="templates.html">
<span class="material-symbols-outlined">description</span>
<span class="sidebar-text hidden">Templates</span>
</a>
<a class="flex items-center justify-center gap-3 px-4 py-2.5 rounded-lg text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-background-dark hover:text-text-light dark:hover:text-text-dark transition-colors duration-200 sidebar-nav-link" href="documents.html">
<span class="material-symbols-outlined">school</span>
<span class="sidebar-text hidden">Registrar Forms</span>
</a>
</nav>
<div class="px-4 py-4 border-t border-border-light dark:border-border-dark">
<div class="flex items-center justify-between profile-container">
<div class="flex items-center gap-3">
<div class="w-10 h-10 rounded-full bg-cover bg-center sidebar-profile-picture hidden" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuC23fvgOSZIK6K5vguUgvVeU1XYFfp1LB3d4zICMvW6bispRl-eHHfnOtSsvRU3MgvmOpSYMCZhcSBIksvjlEHtkGMxuCFsQkuT0suo2-O9n3py7mlzFFETXCOIfvLVGGUj1aaG8ENOeDXXy_ifek2uG3R3--ghDflKvuAm9vrceoK8doav0lNYVbLz1bnWy6REWcrCPuPZZ8upfPqShoQpSDjICl16zMEcRuHzjt05z9cFITLKPdZTfMF-1dLK-klh8UhjeDeE4Q7p");'></div>
<div class="sidebar-profile-info hidden">
<p class="font-semibold text-text-light dark:text-text-dark">Admin User</p>
<a class="text-sm text-primary-600 dark:text-primary-400 hover:underline" href="profile.html">View Profile</a>
</div>
</div>
<button class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-background-dark transition-colors" id="sidebar-toggle">
<span class="material-symbols-outlined sidebar-toggle-icon-open hidden">chevron_left</span>
<span class="material-symbols-outlined sidebar-toggle-icon-closed block">chevron_right</span>
</button>
</div>
</div>
</aside>
<main class="flex-1 overflow-y-auto">
<header class="sticky top-0 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm z-30 px-6 lg:px-8 py-4 border-b border-border-light dark:border-border-dark flex justify-between items-center h-20">
<h1 class="text-2xl font-bold text-text-light dark:text-text-dark">Events & Activities</h1>
<div class="flex items-center gap-2">
<button class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-200 dark:hover:bg-white/10 text-text-muted-light dark:text-text-muted-dark transition-colors duration-200">
<span class="material-symbols-outlined">notifications</span>
</button>
<button class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-200 dark:hover:bg-white/10 text-text-muted-light dark:text-text-muted-dark transition-colors duration-200" id="theme-toggle">
<span class="material-symbols-outlined dark:hidden">light_mode</span>
<span class="material-symbols-outlined hidden dark:inline">dark_mode</span>
</button>
</div>
</header>
<div class="p-6">
  <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
    <div class="xl:col-span-2 space-y-6">
      <div id="eligibleCards" class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Dynamic award-eligible cards will be injected here -->
      </div>

      <div class="bg-card-light dark:bg-card-dark p-6 rounded-xl shadow-soft">
        <div class="flex justify-between items-center mb-4">
          <div>
            <h3 class="text-xl font-bold text-text-light dark:text-text-dark">Upcoming Event</h3>
            <p class="text-sm text-text-muted-light dark:text-text-muted-dark">Don't miss out—get notified for your favorite upcoming events.</p>
          </div>
          
      </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          <div class="space-y-3">
            <img alt="Wellness event banner" class="w-full h-32 object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCyLk-1H8jxRpdsJ34k3wDPRRi3VLfhuOoicTtQrVrw1d_FH52wGjT2dYbvj8HtUqfzX9WRMdoQcXhb_xIk8q4nIE6txehsMwRUShTrcCxwQxcdRkvDe5D83A7X_YBt-_7zWWZ5zHzKPqDEh5zDtyM7JsXFuYzLfHyJHc9UmrkQZ_Wig-pdiB6xJSi50cVc-IGgtMX1v0Et2aYe4qyTy2MTJoAII_X88Wjs5KrTLksgb_v2n_JpJsUKjKjAbzYFUa20rQMpTfnlEFV4"/>
            <h4 class="font-semibold text-text-light dark:text-text-dark">Mind & Mood: Wellness and Yoga Retreat</h4>
            <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">location_on</span> ABC Green Fields, Bali, Indonesia</p>
            <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">calendar_today</span> Oct 20, 2025 ⋅ 8:30 - 9:00 AM</p>
            <button class="w-full bg-primary/10 text-primary font-semibold py-2 rounded-lg hover:bg-primary/20 transition-colors">Remind Me</button>
      </div>
          <div class="space-y-3">
            <img alt="DJ festival banner" class="w-full h-32 object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCkjMPIVPmYRe4OOkEbwIF9c1f70eFaDpMkpCijbWXONpOQkG8bE5ABsxQNvN_1MNFq9S54YkZttjOZ52YThD89EXZO-10aBYugt9QolMfqkYLDfMWliYUTQ_5OFSs2GgDXBMWddJqTO2j-h4EH9NuLkYxOXh9jFFa2L5z2wOgIuU_Ie5hDd7_aq9-SYIw-uRt8CvUv_iH9B6D6QuoYZ_PFdILrLIj1pqqyXDLOs6LYR3dlXjd_nI3lPhLcwYVxuz5tkO2AeoqAkJOI"/>
            <h4 class="font-semibold text-text-light dark:text-text-dark">Sunset Beats Festival: Live DJ Marathon</h4>
            <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">location_on</span> Marina Bay Sands, Singapore</p>
            <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">calendar_today</span> Oct 12, 2025 ⋅ 4:00 - 11:00 PM</p>
            <button class="w-full bg-primary/10 text-primary font-semibold py-2 rounded-lg hover:bg-primary/20 transition-colors">Remind Me</button>
      </div>
          <div class="space-y-3">
            <img alt="Neon party banner" class="w-full h-32 object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCYGrAR5WI1d-mo-Bt3gC13I9svFmWw02rOdt2DjJzUSfl6byVLl0ydpkOWXCDootUM-tXZ3dy2rsneXjNL5ZpyxA7pNXdF0bmOQGHcFNgSFXQOYBPC2YFnEal_Iowyf_f_t5c0t1gN9AUNZtaXhWm6JMLuHzQxOfMmYH_muWyssbk34sogvRD0tWrr8R7XL6yhmo6k0oGeeksKnaFkqz0r3hzelAI3G8_pq8SA14KqFqP5YzxS-kwTmgAolhT0XQD-kodjpTH-2QV2"/>
            <h4 class="font-semibold text-text-light dark:text-text-dark">Neon Nights Live: The Ultimate DJ Party Experience</h4>
            <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">location_on</span> The Glass Hall, Tokyo, Japan</p>
            <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">calendar_today</span> Nov. 18 2025 ⋅ 5:00 - 9:00 PM</p>
            <button class="w-full bg-primary/10 text-primary font-semibold py-2 rounded-lg hover:bg-primary/20 transition-colors">Remind Me</button>
      </div>
    </div>
  </div>

      

      <div class="bg-card-light dark:bg-card-dark p-6 rounded-xl shadow-soft">
        <div class="flex justify-between items-center mb-4">
          <div>
            <h3 class="text-xl font-bold text-text-light dark:text-text-dark">Top Destinations</h3>
            <p class="text-sm text-text-muted-light dark:text-text-muted-dark">Top locations where unforgettable events happen.</p>
          </div>
          
      </div>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
          <div class="relative rounded-lg overflow-hidden">
            <img alt="Boston" class="w-full h-24 object-cover" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDHNe0QLxtol2rvONurdog1VJ6jxZfwr7qIBBCHLUejzPAOKt1KoloM2RPDWJxBLK-e38UEwPoqIxBPQW03FARIOs2yWwLxH3t1daZO1mzOWZXaO9j8180jZ1d7zN_GQQB44sIppexOqXcAnjBygbDkMC725FsJUnyn3A_4o84RnbwQ5zzC6h_TJ76CMhCpJSSF72FHAe09LgySczibXciFbX9Fz4eEJ0yQp_Yj_hODoUg8gFS_TAkaM8875JygeVlKxMn97q6OplPc"/>
            <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
              <p class="text-white font-bold text-lg">Boston</p>
      </div>
    </div>
          <div class="relative rounded-lg overflow-hidden">
            <img alt="Chicago" class="w-full h-24 object-cover" src="https://lh3.googleusercontent.com/aida-public/AB6AXuDIkVbVAZy8T23An052R8iBghMRKiEEZLIIh-enNk-NVYHaJZjpJiDk1y1XQYjghvxOlLrLPltLTNOaPDzeev2teZZjfIXQJCt2WStZvRuzVsXtjR8AR1Nr3WMIVLmE685ONhjTvxrJg2qDUTMKm07MrL0VLy6MaXFE_Gf68ZAmm5luP9A-rIvfTGyyygClC-HMlumqjlrNksgBTzQfrOpOPRgrD6q1YyskubYWnsncArcMPyqdCLG4Kfts_nozZHx8s8IdU331ejzE"/>
            <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
              <p class="text-white font-bold text-lg">Chicago</p>
      </div>
    </div>
          <div class="relative rounded-lg overflow-hidden">
            <img alt="Atlanta" class="w-full h-24 object-cover" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBjsf3Ii8u0fkOEYmil2txPfbEKNbxuUmip9Or_22pNBNLtg8Cg0ajvT0JVv3My6HSaS58LKDHo8ZEqyNlcBRESvMfcwAtDkiOI2YNSgKqghokeDctcraqdFsvwAtgDiAqOiZS8tdFgKD1wIHmRriPl1dHkjbEJeoMWDPcHRBOIHS4znwreGJq88IZskPP5kl81ynerZXrHbJtHnDKcJC3QuJltWOYvsP9SbVKZOQC5LHUK62lxnC9tu9Ys5eNJXWN6anxOyTRq8SJb"/>
            <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
              <p class="text-white font-bold text-lg">Atlanta</p>
      </div>
      </div>
    </div>
  </div>

      <div class="bg-card-light dark:bg-card-dark p-6 rounded-xl shadow-soft">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold text-text-light dark:text-text-dark">Japan Event</h3>
          
        </div>
        <div class="flex flex-col md:flex-row gap-6">
          <img alt="Japan travel" class="w-full md:w-1/3 h-48 md:h-auto object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuA6M-V6M-lJQTc48iIjkTSO00d9n_QzFqt5T-VDk7KK7byMRoITlrPIb8x4yW9o4F6a7bc4FOwBS9PcTxR7HQ9QfPSEI94GIZmlvh3e0WCGBmEV9lFonyTwUoEWadEbP5-W55POnkgNvCI1rWTwCjgaqEEJOw-Veb4TK7lr_KrSVt2uY1wLbIfoizky8Sq4Bge1u-2v81uSmLCya7t1pF5nzsx7zgSro_4fseriJHH6A-wl0C5QVEyY9WyizXsaEa7Aeuf9uQNfm9r0"/>
          <div class="flex-1 space-y-3">
            <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-background-dark">
              <p class="font-bold text-lg text-text-muted-light dark:text-text-muted-dark">20 <span class="block text-xs font-normal">May</span></p>
              <div>
                <p class="font-semibold text-text-light dark:text-text-dark">The Weekend</p>
                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">The Glass Hall, Tokyo, Japan</p>
              </div>
            </div>
            <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-background-dark">
              <p class="font-bold text-lg text-text-muted-light dark:text-text-muted-dark">22 <span class="block text-xs font-normal">May</span></p>
              <div>
                <p class="font-semibold text-text-light dark:text-text-dark">Blackpink</p>
                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">The Glass Hall, Tokyo, Japan</p>
              </div>
            </div>
            <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-background-dark">
              <p class="font-bold text-lg text-text-muted-light dark:text-text-muted-dark">26 <span class="block text-xs font-normal">May</span></p>
              <div>
                <p class="font-semibold text-text-light dark:text-text-dark">Twice</p>
                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">The Glass Hall, Tokyo, Japan</p>
          </div>
        </div>
            <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-background-dark">
              <p class="font-bold text-lg text-text-muted-light dark:text-text-muted-dark">30 <span class="block text-xs font-normal">May</span></p>
              <div>
                <p class="font-semibold text-text-light dark:text-text-dark">Wanna one</p>
                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">The Glass Hall, Tokyo, Japan</p>
      </div>
    </div>
            <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-background-dark">
              <p class="font-bold text-lg text-text-muted-light dark:text-text-muted-dark">2 <span class="block text-xs font-normal">June</span></p>
              <div>
                <p class="font-semibold text-text-light dark:text-text-dark">BTS</p>
                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">The Glass Hall, Tokyo, Japan</p>
              </div>
        </div>
          </div>
        </div>
      </div>
    </div>

    <div class="space-y-6">
      <div class="flex justify-end">
        <button id="addEventBtn" class="flex items-center gap-2 px-3 py-2 text-sm font-semibold text-white bg-primary rounded-lg hover:bg-primary/90 transition-colors">
          <span class="material-symbols-outlined">add</span>
          <span>Add Event</span>
        </button>
      </div>
      <div class="bg-card-light dark:bg-card-dark p-4 rounded-xl shadow-soft">
        <div class="flex justify-between items-center mb-4">
          <button id="prevMonth" class="p-1 rounded-full hover:bg-gray-100 dark:hover:bg-background-dark transition-colors">
            <span class="material-symbols-outlined">chevron_left</span>
          </button>
          <h4 id="calendarTitle" class="font-semibold text-text-light dark:text-text-dark">Loading...</h4>
          <div class="flex items-center gap-2">
            <button id="nextMonth" class="p-1 rounded-full hover:bg-gray-100 dark:hover:bg-background-dark transition-colors">
            <span class="material-symbols-outlined">chevron_right</span>
            </button>
          </div>
        </div>
        <div class="grid grid-cols-7 text-center text-xs text-text-muted-light dark:text-text-muted-dark" id="calendarGrid">
          <div class="py-2">S</div>
          <div class="py-2">M</div>
          <div class="py-2">T</div>
          <div class="py-2">W</div>
          <div class="py-2">T</div>
          <div class="py-2">F</div>
          <div class="py-2">S</div>
          <!-- Calendar days will be generated dynamically -->
        </div>
        <div class="mt-3 pt-3 border-t border-border-light dark:border-border-dark">
          <div class="flex items-center justify-center gap-4 text-xs text-text-muted-light dark:text-text-muted-dark">
            <div class="flex items-center gap-1">
              <div class="w-1 h-1 bg-primary rounded-full"></div>
              <span>Scheduled Events</span>
            </div>
          </div>
        </div>
      </div>
      <div class="bg-card-light dark:bg-card-dark p-4 rounded-xl shadow-soft">
        <div id="todayEventsContainer" class="space-y-4">
          <!-- Today's events will be dynamically loaded here -->
        </div>
      </div>
      <!-- Popular Event moved under mini calendar list -->
      <div class="bg-card-light dark:bg-card-dark p-6 rounded-xl shadow-soft">
        <div class="flex justify-between items-center mb-4">
          <div>
            <h3 class="text-xl font-bold text-text-light dark:text-text-dark">Popular Event</h3>
            <p class="text-sm text-text-muted-light dark:text-text-muted-dark">These events are selling fast—join the crowd!</p>
          </div>
            
        </div>
        <div class="space-y-4">
          <div class="flex items-center gap-4">
            <img alt="Art Exhibition" class="w-16 h-16 object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuAv0_OWoSDnuUvuNpwv6pHQPF_6_kjVJMntw1rTrEaK_h0uhsRNvK6fAzvjFZ7YLratne-m1Ysmcm6Ghzfo1CMq1ZH-vPo8sgSIIUKHiOmL_NuKptRDeF6MtLr0RiMppNYyEFtYC1yIgY-W6w6rqYXwZtgbk71jPww0S5iVMezgNFNHfe1SJaNMhBfiGdM1l_JBveuiQryjRAXj0DoZa36Tu8PZPLo1A4bIaOFqsWDxEcMk8nUAz6u4knynKEY1y25YMDrP2i60hvwh"/>
            <div class="flex-1">
              <p class="font-semibold text-text-light dark:text-text-dark">Art Exhibition</p>
              <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">calendar_today</span> June 10 <span class="material-symbols-outlined text-xs align-middle ml-2">schedule</span> 4:00 PM</p>
              <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> Paris, FR</p>
      </div>
            <p class="font-bold text-lg text-primary">$40 <span class="text-sm font-normal text-text-muted-light dark:text-text-muted-dark">/ticket</span></p>
    </div>
          <div class="flex items-center gap-4">
            <img alt="Future of AI" class="w-16 h-16 object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCGPeGTPD62y9D6O23CKkvIBndIHtFt4YP_DEZoItI0grinOA7lTx1rm5uSj6LTqEaNBqQxMbyYURSXJWXUXkp0ggM8nYYR3jAJJEN-CYyAAuTMWff00ahrBiyAlFe0TL1RNK5wd32ZIFbyggH_Yxx_f7BnxQFZpTDEgUWqUKGgu_enMdMsNcyI2MOSjy8mxIRh9RXPZ9HjVuEAHOAmduX9-3bUtGPKZQVKfF4d3eL6gghd450OnC5fsjhgJM5BAX1cF0mKmjf3SrxT"/>
            <div class="flex-1">
              <p class="font-semibold text-text-light dark:text-text-dark">Future of AI</p>
              <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">calendar_today</span> July 5 <span class="material-symbols-outlined text-xs align-middle ml-2">schedule</span> 5:00 PM</p>
              <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> Berlin, DE</p>
  </div>
            <p class="font-bold text-lg text-primary">$75 <span class="text-sm font-normal text-text-muted-light dark:text-text-muted-dark">/ticket</span></p>
</div>
          <div class="flex items-center gap-4">
            <img alt="Outdoor Festival" class="w-16 h-16 object-cover rounded-lg" src="https://lh3.googleusercontent.com/aida-public/AB6AXuBvnGdmpp_wRbkMXjOYMPoCvwfD9x_20mxYnYF7qlPQyDxEXgmgm2rMjUg8k-iLNn5YgExBTU-aer8QElFFzTUQaAIDldZk6yvOZhQd7AAIeBS5-JIK1EjdLrRk02m8MJouOpqK6yUOPMYaq0mYI_6YcGRT3ujSzdMb4x_enn7NZv7Dmi-cbZt5snxdbE2z4cqwJm9_u5ik9ukTiBkODaj4YtemYUbMyVGRG-LRaZX68O0lkEkhnps3VUMeFd0L7oEitgGm_Pt6pppz"/>
            <div class="flex-1">
              <p class="font-semibold text-text-light dark:text-text-dark">Outdoor Festival</p>
              <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">calendar_today</span> July 8 <span class="material-symbols-outlined text-xs align-middle ml-2">schedule</span> 3:00 PM</p>
              <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> New York, US</p>
    </div>
            <p class="font-bold text-lg text-primary">$55 <span class="text-sm font-normal text-text-muted-light dark:text-text-muted-dark">/ticket</span></p>
      </div>
      </div>
      </div>
    </div>
  </div>
</div>
</main>
</div>
<!-- Add Event Modal -->
<div id="addEventModal" class="fixed inset-0 bg-black/30 hidden items-center justify-center z-[9999]">
  <div class="bg-white dark:bg-card-dark rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[85vh] overflow-y-auto border border-border-light dark:border-border-dark relative">
    <button id="closeAddEvent" class="absolute top-2 right-2 rounded-full p-2 hover:bg-gray-100 dark:hover:bg-white/10">
      <span class="material-symbols-outlined">close</span>
    </button>
    <div class="p-3 pt-10">
      <input id="evTitle" type="text" class="w-full text-xl font-medium bg-transparent border-0 border-b border-border-light dark:border-border-dark focus:border-primary focus:ring-0 focus:outline-none pb-1.5 mb-2 placeholder:text-text-muted-light dark:placeholder:text-text-muted-dark" placeholder="Add title" />
      <div class="space-y-3">
        <div class="flex items-start gap-3">
          <span class="material-symbols-outlined text-text-muted-light dark:text-text-muted-dark mt-1">schedule</span>
          <div class="flex-1">
            <div class="flex items-center gap-2 flex-wrap relative" id="timeRangeContainer">
              <input id="evDate" type="date" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-full text-sm font-medium text-text-light dark:text-text-dark dark:bg-white/10 border-0 outline-none focus:outline-none ring-0 focus:ring-0" placeholder="mm/dd/yyyy" />
              <button id="evTimeRangeBtn" type="button" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-full text-sm font-medium text-text-light dark:text-text-dark dark:bg-white/10 border-0 outline-none">
                <span id="evTimeRangeText">--:-- -- - --:-- --</span>
              </button>
              <!-- Time range popover -->
              <div id="timeRangePopover" class="hidden absolute z-50 top-12 left-0 bg-white dark:bg-card-dark border border-border-light dark:border-border-dark rounded-xl shadow-xl w-72 max-h-80 overflow-y-auto">
                <div class="p-2 border-b border-border-light dark:border-border-dark flex items-center gap-2">
                  <button id="timeTabStart" class="px-3 py-1.5 rounded-lg text-sm font-medium bg-primary/10 text-primary">Start</button>
                  <button id="timeTabEnd" class="px-3 py-1.5 rounded-lg text-sm font-medium">End</button>
                </div>
                <div id="timeOptions" class="p-2 space-y-1"></div>
              </div>
            </div>
            
          </div>
        </div>
        
        <div class="flex items-center gap-3">
          <span class="material-symbols-outlined text-text-muted-light dark:text-text-muted-dark">place</span>
          <div class="flex-1">
            <input id="evLocation" type="text" class="w-full bg-transparent border-0 border-b border-transparent outline-none focus:outline-none ring-0 focus:ring-0 focus:border-border-light dark:focus:border-border-dark shadow-none focus:shadow-none text-sm transition-colors" placeholder="Add location (e.g., Iloilo)" style="box-shadow: none !important;" />
            <div id="locationSuggestions" class="hidden mt-2 rounded-lg border border-border-light dark:border-border-dark bg-white dark:bg-card-dark shadow-lg max-h-48 overflow-y-auto">
              <div id="suggestionsList" class="p-2 space-y-1">
                <!-- Location suggestions will appear here -->
              </div>
            </div>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <span class="material-symbols-outlined text-text-muted-light dark:text-text-muted-dark">description</span>
          <input id="evDesc" type="text" class="flex-1 bg-transparent border-0 border-b border-transparent outline-none focus:outline-none ring-0 focus:ring-0 focus:border-border-light dark:focus:border-border-dark shadow-none focus:shadow-none text-sm transition-colors" placeholder="Add description or a Google Drive attachment" style="box-shadow: none !important;" />
        </div>
      </div>
      <div class="flex items-center justify-end mt-3">
        <button id="saveAddEvent" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 font-medium">Save</button>
      </div>
    </div>
  </div>
  
</div>

<!-- Reminder Selection Modal -->
<div id="reminderModal" class="fixed inset-0 bg-black/30 hidden items-center justify-center z-[9999]">
  <div class="bg-white dark:bg-card-dark rounded-lg shadow-xl w-full max-w-md mx-4 border border-border-light dark:border-border-dark relative">
    <button id="closeReminderModal" class="absolute top-2 right-2 rounded-full p-2 hover:bg-gray-100 dark:hover:bg-white/10">
      <span class="material-symbols-outlined">close</span>
    </button>
    <div class="p-6 pt-12">
      <div class="mb-4">
        <h3 class="text-lg font-semibold text-text-light dark:text-text-dark">Set Reminder</h3>
        <p class="text-sm text-text-muted-light dark:text-text-muted-dark mt-1">Choose when you'd like to be reminded about this event</p>
      </div>
      
      <div id="eventInfo" class="mb-6 p-3 bg-gray-50 dark:bg-white/5 rounded-lg">
        <h4 class="font-medium text-text-light dark:text-text-dark" id="reminderEventTitle"></h4>
        <p class="text-sm text-text-muted-light dark:text-text-muted-dark" id="reminderEventDateTime"></p>
      </div>
      
      <div class="space-y-3">
        <label class="flex items-center p-3 border border-border-light dark:border-border-dark rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
          <input type="radio" name="reminderTime" value="1hour" class="mr-3">
          <div>
            <div class="font-medium text-text-light dark:text-text-dark">1 Hour Before</div>
            <div class="text-sm text-text-muted-light dark:text-text-muted-dark">Quick reminder for immediate events</div>
          </div>
        </label>
        
        <label class="flex items-center p-3 border border-border-light dark:border-border-dark rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
          <input type="radio" name="reminderTime" value="1day" class="mr-3">
          <div>
            <div class="font-medium text-text-light dark:text-text-dark">1 Day Before</div>
            <div class="text-sm text-text-muted-light dark:text-text-muted-dark">Standard advance notice</div>
          </div>
        </label>
        
        <label class="flex items-center p-3 border border-border-light dark:border-border-dark rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
          <input type="radio" name="reminderTime" value="1week" class="mr-3">
          <div>
            <div class="font-medium text-text-light dark:text-text-dark">1 Week Before</div>
            <div class="text-sm text-text-muted-light dark:text-text-muted-dark">Early planning reminder</div>
          </div>
        </label>
        
        <label class="flex items-center p-3 border border-border-light dark:border-border-dark rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-white/5 transition-colors">
          <input type="radio" name="reminderTime" value="custom" class="mr-3">
          <div class="flex-1">
            <div class="font-medium text-text-light dark:text-text-dark">Custom Time</div>
            <div class="text-sm text-text-muted-light dark:text-text-muted-dark mb-2">Set your own reminder time</div>
            <div class="flex items-center gap-2">
              <input type="number" id="customDays" min="0" max="365" class="w-16 px-2 py-1 border border-border-light dark:border-border-dark rounded text-sm bg-transparent" placeholder="0">
              <span class="text-sm text-text-muted-light dark:text-text-muted-dark">days before</span>
            </div>
          </div>
        </label>
      </div>
      
      <div class="flex items-center justify-end mt-6 gap-3">
        <button id="cancelReminder" class="px-4 py-2 text-text-muted-light dark:text-text-muted-dark hover:text-text-light dark:hover:text-text-dark transition-colors">Cancel</button>
        <button id="setReminder" class="bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary/90 font-medium">Set Reminder</button>
      </div>
    </div>
  </div>
</div>

<script>
        document.addEventListener('DOMContentLoaded', () => {
            const themeToggle = document.getElementById('theme-toggle');
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const appContainer = document.getElementById('app-container');
            const sidebar = document.querySelector('.sidebar');
            const mainContent = document.querySelector('main');
            const sidebarLogoText = document.querySelector('.sidebar-logo-text');
            const sidebarTexts = document.querySelectorAll('.sidebar-text');
            const sidebarProfileInfo = document.querySelector('.sidebar-profile-info');
            const sidebarProfilePicture = document.querySelector('.sidebar-profile-picture');
            const openIcon = document.querySelector('.sidebar-toggle-icon-open');
            const closedIcon = document.querySelector('.sidebar-toggle-icon-closed');
            const navLinks = document.querySelectorAll('.sidebar-nav-link');
            const profileContainer = document.querySelector('.profile-container');
            const toggleContainer = document.querySelector('.sidebar-toggle-container');
            // Prevent navigating when clicking the current page link
            const currentPath = window.location.pathname.split('/').pop();
            navLinks.forEach(link => {
                const href = link.getAttribute('href');
                if (href === currentPath) {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                    });
                }
            });
            // Function to toggle sidebar
            const toggleSidebar = () => {
                const isCollapsed = appContainer.classList.contains('sidebar-collapsed');
                if (isCollapsed) {
                    appContainer.classList.remove('sidebar-collapsed');
                    appContainer.classList.add('sidebar-expanded');
                    // Clear any inline styles so CSS classes control layout
                    sidebar.style.width = '';
                    mainContent.style.marginLeft = '';
                    sidebarLogoText.classList.remove('hidden');
                    sidebarTexts.forEach(text => text.classList.remove('hidden'));
                    sidebarProfileInfo.classList.remove('hidden');
                    sidebarProfilePicture.classList.remove('hidden');
                    openIcon.style.display = 'block';
                    closedIcon.style.display = 'none';
                    navLinks.forEach(link => link.classList.remove('justify-center'));
                    profileContainer.classList.remove('justify-center');
                    toggleContainer.classList.remove('justify-center');
                } else {
                    appContainer.classList.add('sidebar-collapsed');
                    appContainer.classList.remove('sidebar-expanded');
                    // Clear any inline styles so CSS classes control layout
                    sidebar.style.width = '';
                    mainContent.style.marginLeft = '';
                    sidebarLogoText.classList.add('hidden');
                    sidebarTexts.forEach(text => text.classList.add('hidden'));
                    sidebarProfileInfo.classList.add('hidden');
                    sidebarProfilePicture.classList.add('hidden');
                    openIcon.style.display = 'none';
                    closedIcon.style.display = 'block';
                    navLinks.forEach(link => link.classList.add('justify-center'));
                    profileContainer.classList.add('justify-center');
                    toggleContainer.classList.add('justify-center');
                }
                // Add a small delay for the chart to re-render after transition
                setTimeout(() => {
                    if (window.awardsProgressChartInstance) {
                        window.awardsProgressChartInstance.resize();
                    }
                }, 350);
            };
            sidebarToggle.addEventListener('click', toggleSidebar);
            // Function to toggle dark mode
            const toggleDarkMode = (enable) => {
                if (enable) {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('theme', 'light');
                }
                // Force a re-render to ensure all elements update
                document.body.offsetHeight;
            };
            // Check for saved theme in localStorage
            if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                toggleDarkMode(true);
            } else {
                toggleDarkMode(false);
            }
            // Event listener for theme toggle button
            themeToggle.addEventListener('click', () => {
                const isCurrentlyDark = document.documentElement.classList.contains('dark');
                toggleDarkMode(!isCurrentlyDark);
                // Re-render chart on theme change
                if (window.awardsProgressChartInstance) {
                    window.awardsProgressChartInstance.destroy();
                }
                renderChart();
            });
            // Chart.js rendering
            const renderChart = () => {
                const canvas = document.getElementById('awardsProgressChart');
                if (!canvas) return; // no chart on this page
                const ctx = canvas.getContext('2d');
                const isDarkMode = document.documentElement.classList.contains('dark');
                const gridColor = isDarkMode ? tailwind.theme.extend.colors.border-dark : tailwind.theme.extend.colors.border-light;
                const tickColor = isDarkMode ? tailwind.theme.extend.colors['text-muted-dark'] : tailwind.theme.extend.colors['text-muted-light'];
                const legendColor = isDarkMode ? tailwind.theme.extend.colors['text-dark'] : tailwind.theme.extend.colors['text-light'];
                const data = {
                    labels: ['Teaching', 'Research', 'Extension', 'Support', 'Admin'],
                    datasets: [{
                        label: 'Award Progress',
                        data: [75, 60, 90, 45, 82],
                        backgroundColor: [
                            'rgba(19, 127, 236, 0.2)', // primary
                            'rgba(34, 197, 94, 0.2)', // green
                            'rgba(234, 179, 8, 0.2)', // yellow
                            'rgba(239, 68, 68, 0.2)', // red
                            'rgba(99, 102, 241, 0.2)', // indigo
                        ],
                        borderColor: [
                            'rgb(19, 127, 236)', // primary
                            'rgb(34, 197, 94)', // green
                            'rgb(234, 179, 8)', // yellow
                            'rgb(239, 68, 68)', // red
                            'rgb(99, 102, 241)', // indigo
                        ],
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                };
                const options = {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false,
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: gridColor,
                                drawBorder: false,
                            },
                            ticks: {
                                color: tickColor,
                                padding: 10,
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false,
                            },
                            ticks: {
                                color: tickColor,
                                padding: 10,
                            }
                        }
                    }
                };
                window.awardsProgressChartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: data,
                    options: options
                });
            };
            if (typeof renderChart === 'function') renderChart();

            // Add Event modal handlers (restored)
            const addEventBtn = document.getElementById('addEventBtn');
            const addEventModal = document.getElementById('addEventModal');
            const closeAddEvent = document.getElementById('closeAddEvent');
            const cancelAddEvent = document.getElementById('cancelAddEvent');
            const saveAddEvent = document.getElementById('saveAddEvent');

            const openModal = () => {
                if (addEventModal) { addEventModal.classList.remove('hidden'); addEventModal.classList.add('flex'); }
            };
            const closeModal = () => {
                if (addEventModal) { addEventModal.classList.add('hidden'); addEventModal.classList.remove('flex'); }
            };
            addEventBtn && addEventBtn.addEventListener('click', openModal);
            closeAddEvent && closeAddEvent.addEventListener('click', closeModal);
            cancelAddEvent && cancelAddEvent.addEventListener('click', closeModal);

            saveAddEvent && saveAddEvent.addEventListener('click', () => {
                // Get event data from modal
                const title = document.getElementById('evTitle').value || 'Untitled Event';
                const date = document.getElementById('evDate').value;
                const timeRange = document.getElementById('evTimeRangeText').textContent || '--:-- -- - --:-- --';
                const location = document.getElementById('evLocation').value || '';
                const description = document.getElementById('evDesc').value || '';
                
                // Validate required fields
                if (!title.trim() || !date) {
                    alert('Please fill in the event title and date.');
                    return;
                }
                
                // Check if event is in the future (for upcoming events section only)
                const eventDate = new Date(date);
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Reset time to start of day for comparison
                
                const isFutureEvent = eventDate >= today;
                
                // Create event object with assigned image
                const eventData = {
                    id: Date.now(), // Simple ID generation
                    title: title.trim(),
                    date: date,
                    timeRange: timeRange,
                    location: location.trim(),
                    description: description.trim(),
                    imageUrl: getRandomEventImage(), // Assign image once and store it
                    createdAt: new Date().toISOString()
                };
                
                // Save to localStorage (all events, regardless of date)
                const savedEvents = JSON.parse(localStorage.getItem('upcomingEvents') || '[]');
                savedEvents.push(eventData);
                localStorage.setItem('upcomingEvents', JSON.stringify(savedEvents));
                
                // Debug logging
                console.log('Event saved:', eventData);
                console.log('All saved events:', savedEvents);
                
                // Add to upcoming events section only if it's a future event
                if (isFutureEvent) {
                    addEventToUpcomingSection(eventData);
                }
                
                // Refresh today's events if the new event is today
                loadTodayEvents();
                
                // Refresh calendar to show event indicators
                setTimeout(() => {
                    if (typeof window.renderCalendar === 'function') {
                        console.log('Refreshing calendar...');
                        window.renderCalendar();
                    }
                }, 100);
                
                // Clear form
                document.getElementById('evTitle').value = '';
                document.getElementById('evDate').value = '';
                document.getElementById('evTimeRangeText').textContent = '--:-- -- - --:-- --';
                document.getElementById('evLocation').value = '';
                document.getElementById('evDesc').value = '';
                
                // Close modal
                closeModal();
            });

            // Function to create a fallback data URL image
            function createFallbackImage(title) {
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 200;
                const ctx = canvas.getContext('2d');
                
                // Create gradient background
                const gradient = ctx.createLinearGradient(0, 0, 400, 200);
                gradient.addColorStop(0, '#137fec');
                gradient.addColorStop(1, '#0c4c8d');
                
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, 400, 200);
                
                // Add text
                ctx.fillStyle = 'white';
                ctx.font = 'bold 24px Inter, sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                // Wrap text if too long
                const words = title.toUpperCase().split(' ');
                let line = '';
                let y = 80;
                
                for (let i = 0; i < words.length; i++) {
                    const testLine = line + words[i] + ' ';
                    const metrics = ctx.measureText(testLine);
                    const testWidth = metrics.width;
                    
                    if (testWidth > 350 && i > 0) {
                        ctx.fillText(line, 200, y);
                        line = words[i] + ' ';
                        y += 30;
                    } else {
                        line = testLine;
                    }
                }
                ctx.fillText(line, 200, y);
                
                // Add event icon
                ctx.font = '48px Material Symbols Outlined';
                ctx.fillText('📅', 200, 120);
                
                return canvas.toDataURL();
            }

            // Function to get unique random event image
            function getRandomEventImage() {
                const eventImages = [
                    // More reliable image sources - using direct image URLs
                    'https://source.unsplash.com/400x200/?conference',
                    'https://source.unsplash.com/400x200/?meeting',
                    'https://source.unsplash.com/400x200/?event',
                    'https://source.unsplash.com/400x200/?business',
                    'https://source.unsplash.com/400x200/?workshop',
                    'https://source.unsplash.com/400x200/?seminar',
                    'https://source.unsplash.com/400x200/?training',
                    'https://source.unsplash.com/400x200/?presentation',
                    'https://source.unsplash.com/400x200/?networking',
                    'https://source.unsplash.com/400x200/?education',
                    'https://source.unsplash.com/400x200/?technology',
                    'https://source.unsplash.com/400x200/?innovation',
                    'https://source.unsplash.com/400x200/?teamwork',
                    'https://source.unsplash.com/400x200/?collaboration',
                    'https://source.unsplash.com/400x200/?development',
                    'https://source.unsplash.com/400x200/?learning',
                    'https://source.unsplash.com/400x200/?community',
                    'https://source.unsplash.com/400x200/?celebration',
                    'https://source.unsplash.com/400x200/?achievement',
                    'https://source.unsplash.com/400x200/?success',
                    
                    // Additional reliable sources
                    'https://source.unsplash.com/400x200/?office',
                    'https://source.unsplash.com/400x200/?professional',
                    'https://source.unsplash.com/400x200/?leadership',
                    'https://source.unsplash.com/400x200/?growth',
                    'https://source.unsplash.com/400x200/?future',
                    'https://source.unsplash.com/400x200/?progress',
                    'https://source.unsplash.com/400x200/?inspiration',
                    'https://source.unsplash.com/400x200/?motivation',
                    'https://source.unsplash.com/400x200/?goals',
                    'https://source.unsplash.com/400x200/?vision'
                ];
                
                // Get currently used images from stored events
                const savedEvents = JSON.parse(localStorage.getItem('upcomingEvents') || '[]');
                const usedImages = new Set();
                
                // Add images from stored events
                savedEvents.forEach(event => {
                    if (event.imageUrl) {
                        usedImages.add(event.imageUrl);
                    }
                });
                
                // Filter out used images
                const availableImages = eventImages.filter(img => !usedImages.has(img));
                
                // If all images are used, reset and use any image
                if (availableImages.length === 0) {
                    return eventImages[Math.floor(Math.random() * eventImages.length)];
                }
                
                // Return a random image from available images
                return availableImages[Math.floor(Math.random() * availableImages.length)];
            }

            // Function to add event to upcoming events section
            function addEventToUpcomingSection(eventData) {
                const upcomingEventsContainer = document.querySelector('.grid.grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3.gap-4');
                if (!upcomingEventsContainer) return;
                
                // Use stored image URL or get a new one if not available (for backward compatibility)
                let eventImage = eventData.imageUrl || getRandomEventImage();
                
                // If no image URL is available, create a fallback
                if (!eventImage) {
                    eventImage = createFallbackImage(eventData.title);
                }
                
                // Create event card
                const eventCard = document.createElement('div');
                eventCard.className = 'space-y-3';
                eventCard.setAttribute('data-dynamic', 'true');
                eventCard.setAttribute('data-event-id', eventData.id);
                eventCard.innerHTML = `
                    <div class="w-full h-32 bg-gradient-to-br from-primary/20 to-primary/40 rounded-lg flex items-center justify-center overflow-hidden">
                        <img alt="${eventData.title} banner" class="w-full h-full object-cover rounded-lg" 
                             src="${eventImage}" 
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                             onload="this.nextElementSibling.style.display='none';"
                             loading="lazy"/>
                        <div class="hidden w-full h-full bg-gradient-to-br from-primary/30 to-primary/50 rounded-lg flex items-center justify-center">
                            <div class="text-center text-white">
                                <span class="material-symbols-outlined text-4xl mb-2">event</span>
                                <p class="text-sm font-medium">${eventData.title.toUpperCase()}</p>
                            </div>
                        </div>
                    </div>
                    <h4 class="font-semibold text-text-light dark:text-text-dark">${eventData.title.toUpperCase()}</h4>
                    <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">location_on</span> ${eventData.location || 'Location not specified'}</p>
                    <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-sm align-middle">calendar_today</span> ${formatEventDate(eventData.date)} ⋅ ${eventData.timeRange}</p>
                    <button class="w-full bg-primary/10 text-primary font-semibold py-2 rounded-lg hover:bg-primary/20 transition-colors remind-me-btn" data-event-id="${eventData.id}" data-event-title="${eventData.title}" data-event-date="${eventData.date}" data-event-time="${eventData.timeRange}">Remind Me</button>
                `;
                
                // Add to the container
                upcomingEventsContainer.appendChild(eventCard);
                
                // Limit to 3 events maximum (remove oldest dynamic events if needed)
                const dynamicEvents = upcomingEventsContainer.querySelectorAll('[data-dynamic="true"]');
                if (dynamicEvents.length > 3) {
                    dynamicEvents[0].remove(); // Remove the oldest (first) event
                }
            }

            // Function to format event date
            function formatEventDate(dateString) {
                const date = new Date(dateString);
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                return `${months[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
            }

            // Function to load existing events from localStorage
            function loadUpcomingEvents() {
                const savedEvents = JSON.parse(localStorage.getItem('upcomingEvents') || '[]');
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                // Filter future events and sort by date
                const futureEvents = savedEvents
                    .filter(event => new Date(event.date) >= today)
                    .sort((a, b) => new Date(a.date) - new Date(b.date))
                    .slice(0, 3); // Show only the next 3 events
                
                const upcomingEventsContainer = document.querySelector('.grid.grid-cols-1.sm\\:grid-cols-2.lg\\:grid-cols-3.gap-4');
                if (!upcomingEventsContainer) return;
                
                // If we have saved events, replace the static content
                if (futureEvents.length > 0) {
                    // Clear all existing content
                    upcomingEventsContainer.innerHTML = '';
                    
                    // Add saved events
                    futureEvents.forEach(event => {
                        addEventToUpcomingSection(event);
                    });
                }
                // If no saved events, keep the original static content (do nothing)
            }

            // Function to load today's events
            function loadTodayEvents() {
                const todayEventsContainer = document.getElementById('todayEventsContainer');
                if (!todayEventsContainer) return;
                
                const savedEvents = JSON.parse(localStorage.getItem('upcomingEvents') || '[]');
                const today = new Date();
                const todayString = today.toISOString().split('T')[0]; // Format: YYYY-MM-DD
                
                // Filter events for today and limit to 5
                const todayEvents = savedEvents.filter(event => event.date === todayString).slice(0, 5);
                
                // Clear container
                todayEventsContainer.innerHTML = '';
                
                if (todayEvents.length === 0) {
                    // Show "No events" message
                    todayEventsContainer.innerHTML = `
                        <div class="text-center py-8">
                            <span class="material-symbols-outlined text-4xl text-text-muted-light dark:text-text-muted-dark mb-2">event_busy</span>
                            <p class="text-text-muted-light dark:text-text-muted-dark">No events scheduled for today</p>
                        </div>
                    `;
                } else {
                    // Display today's events (max 5)
                    todayEvents.forEach(event => {
                        const eventDate = new Date(event.date);
                        const dayOfWeek = eventDate.toLocaleDateString('en-US', { weekday: 'short' });
                        const dayOfMonth = eventDate.getDate();
                        
                        const eventElement = document.createElement('div');
                        eventElement.className = 'flex gap-4 items-start';
                        eventElement.innerHTML = `
                            <div class="text-center">
                                <p class="font-bold text-primary">${dayOfMonth}</p>
                                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">${dayOfWeek}</p>
                            </div>
                            <div class="border-l-2 border-primary pl-4">
                                <p class="font-semibold text-sm text-text-light dark:text-text-dark">${event.title.toUpperCase()}</p>
                                <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> ${event.location || 'Location not specified'}</p>
                            </div>
                        `;
                        todayEventsContainer.appendChild(eventElement);
                    });
                }
            }

            // Load events when page loads
            loadUpcomingEvents();
            loadTodayEvents();

            // Reminder System Functionality
            let currentReminderEvent = null;

            // Function to open reminder modal
            function openReminderModal(eventData) {
                currentReminderEvent = eventData;
                const modal = document.getElementById('reminderModal');
                const titleElement = document.getElementById('reminderEventTitle');
                const dateTimeElement = document.getElementById('reminderEventDateTime');
                
                if (modal && titleElement && dateTimeElement) {
                    titleElement.textContent = eventData.title;
                    dateTimeElement.textContent = `${formatEventDate(eventData.date)} ⋅ ${eventData.timeRange}`;
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                }
            }

            // Function to close reminder modal
            function closeReminderModal() {
                const modal = document.getElementById('reminderModal');
                if (modal) {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                    currentReminderEvent = null;
                    
                    // Reset form
                    document.querySelectorAll('input[name="reminderTime"]').forEach(radio => {
                        radio.checked = false;
                    });
                    document.getElementById('customDays').value = '';
                }
            }

            // Function to set reminder
            function setReminder() {
                if (!currentReminderEvent) return;

                const selectedReminder = document.querySelector('input[name="reminderTime"]:checked');
                if (!selectedReminder) {
                    alert('Please select a reminder time.');
                    return;
                }

                let reminderTime = null;
                const eventDate = new Date(currentReminderEvent.date);
                
                // Calculate reminder time based on selection
                switch (selectedReminder.value) {
                    case '1hour':
                        reminderTime = new Date(eventDate.getTime() - (60 * 60 * 1000)); // 1 hour before
                        break;
                    case '1day':
                        reminderTime = new Date(eventDate.getTime() - (24 * 60 * 60 * 1000)); // 1 day before
                        break;
                    case '1week':
                        reminderTime = new Date(eventDate.getTime() - (7 * 24 * 60 * 60 * 1000)); // 1 week before
                        break;
                    case 'custom':
                        const customDays = parseInt(document.getElementById('customDays').value);
                        if (isNaN(customDays) || customDays < 0) {
                            alert('Please enter a valid number of days.');
                            return;
                        }
                        reminderTime = new Date(eventDate.getTime() - (customDays * 24 * 60 * 60 * 1000));
                        break;
                }

                // Check if reminder time is in the past
                if (reminderTime <= new Date()) {
                    alert('Reminder time cannot be in the past. Please choose a different time.');
                    return;
                }

                // Store reminder
                const reminder = {
                    id: Date.now(),
                    eventId: currentReminderEvent.id,
                    eventTitle: currentReminderEvent.title,
                    eventDate: currentReminderEvent.date,
                    eventTime: currentReminderEvent.timeRange,
                    reminderTime: reminderTime.toISOString(),
                    reminderType: selectedReminder.value,
                    createdAt: new Date().toISOString()
                };

                // Save to localStorage
                const savedReminders = JSON.parse(localStorage.getItem('eventReminders') || '[]');
                savedReminders.push(reminder);
                localStorage.setItem('eventReminders', JSON.stringify(savedReminders));

                // Show confirmation
                alert(`Reminder set for ${formatReminderDate(reminderTime)}!`);
                
                // Close modal
                closeReminderModal();

                // Update button text to show reminder is set
                updateReminderButton(currentReminderEvent.id, true);
            }

            // Function to format reminder date
            function formatReminderDate(date) {
                const now = new Date();
                const diffTime = date.getTime() - now.getTime();
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                if (diffDays === 0) {
                    return 'today at ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                } else if (diffDays === 1) {
                    return 'tomorrow at ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                } else if (diffDays > 1) {
                    return `in ${diffDays} days at ` + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                } else {
                    return date.toLocaleDateString() + ' at ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                }
            }

            // Function to update reminder button state
            function updateReminderButton(eventId, hasReminder) {
                const button = document.querySelector(`button[data-event-id="${eventId}"]`);
                if (button) {
                    if (hasReminder) {
                        button.textContent = 'Reminder Set ✓';
                        button.classList.add('bg-green-100', 'text-green-700', 'dark:bg-green-900/20', 'dark:text-green-400');
                        button.classList.remove('bg-primary/10', 'text-primary');
                    } else {
                        button.textContent = 'Remind Me';
                        button.classList.remove('bg-green-100', 'text-green-700', 'dark:bg-green-900/20', 'dark:text-green-400');
                        button.classList.add('bg-primary/10', 'text-primary');
                    }
                }
            }

            // Function to check for reminders
            function checkReminders() {
                const savedReminders = JSON.parse(localStorage.getItem('eventReminders') || '[]');
                const now = new Date();
                
                savedReminders.forEach(reminder => {
                    const reminderTime = new Date(reminder.reminderTime);
                    
                    // Check if it's time to show the reminder (within 1 minute)
                    if (Math.abs(now.getTime() - reminderTime.getTime()) <= 60000) {
                        showNotification(reminder);
                        
                        // Remove the reminder after showing
                        const updatedReminders = savedReminders.filter(r => r.id !== reminder.id);
                        localStorage.setItem('eventReminders', JSON.stringify(updatedReminders));
                        
                        // Update button state
                        updateReminderButton(reminder.eventId, false);
                    }
                });
            }

            // Function to show notification
            function showNotification(reminder) {
                // Request notification permission if not already granted
                if (Notification.permission === 'default') {
                    Notification.requestPermission();
                }
                
                if (Notification.permission === 'granted') {
                    const notification = new Notification(`Event Reminder: ${reminder.eventTitle}`, {
                        body: `Your event is coming up on ${formatEventDate(reminder.eventDate)} at ${reminder.eventTime}`,
                        icon: 'assets/images/cpu-logo.svg.png',
                        tag: `reminder-${reminder.id}`,
                        requireInteraction: true
                    });
                    
                    // Auto-close after 10 seconds
                    setTimeout(() => notification.close(), 10000);
                } else {
                    // Fallback to alert if notifications are not allowed
                    alert(`Reminder: ${reminder.eventTitle}\nYour event is coming up on ${formatEventDate(reminder.eventDate)} at ${reminder.eventTime}`);
                }
            }

            // Event listeners for reminder modal
            document.addEventListener('click', (e) => {
                // Handle "Remind Me" button clicks
                if (e.target.classList.contains('remind-me-btn')) {
                    const eventData = {
                        id: e.target.getAttribute('data-event-id'),
                        title: e.target.getAttribute('data-event-title'),
                        date: e.target.getAttribute('data-event-date'),
                        timeRange: e.target.getAttribute('data-event-time')
                    };
                    openReminderModal(eventData);
                }
                
                // Handle modal close buttons
                if (e.target.id === 'closeReminderModal' || e.target.id === 'cancelReminder') {
                    closeReminderModal();
                }
                
                // Handle set reminder button
                if (e.target.id === 'setReminder') {
                    setReminder();
                }
                
                // Handle custom days input
                if (e.target.id === 'customDays') {
                    document.querySelector('input[name="reminderTime"][value="custom"]').checked = true;
                }
            });

            // Check reminders every minute
            setInterval(checkReminders, 60000);

            // Check for existing reminders on page load
            setTimeout(() => {
                const savedReminders = JSON.parse(localStorage.getItem('eventReminders') || '[]');
                savedReminders.forEach(reminder => {
                    updateReminderButton(reminder.eventId, true);
                });
            }, 1000);

            // Fetch and render award-eligible cards
            const eligibleContainer = document.getElementById('eligibleCards');
            const renderEligibleState = (state) => {
                if (!eligibleContainer) return;
                eligibleContainer.innerHTML = '';
                const base = 'bg-card-light dark:bg-card-dark rounded-xl shadow-soft p-4 flex items-center';
                if (state === 'loading') {
                    for (let i = 0; i < 2; i++) {
                        const sk = document.createElement('div');
                        sk.className = base + ' animate-pulse';
                        sk.innerHTML = `
                          <div class="w-24 h-24 bg-gray-200 dark:bg-white/10 rounded-lg"></div>
                          <div class="flex-1 pl-4 space-y-3">
                            <div class="h-4 w-24 bg-gray-200 dark:bg-white/10 rounded"></div>
                            <div class="h-5 w-48 bg-gray-200 dark:bg-white/10 rounded"></div>
                            <div class="h-4 w-40 bg-gray-200 dark:bg-white/10 rounded"></div>
                          </div>`;
                        eligibleContainer.appendChild(sk);
                    }
                    return;
                }
                if (state === 'empty') {
                    // Show two placeholder cards (reverted behavior)
                    for (let i = 0; i < 2; i++) {
                        eligibleContainer.appendChild(buildPlaceholderCard());
                    }
                }
            };

            const buildEligibleCard = (item) => {
                const wrap = document.createElement('div');
                wrap.className = 'bg-card-light dark:bg-card-dark rounded-xl shadow-soft p-4 flex items-center';
                wrap.innerHTML = `
                  <img alt="${item.category} thumbnail" class="w-24 h-full object-cover rounded-lg" src="${item.thumbnail_url || 'https://via.placeholder.com/96x96?text=img'}"/>
                  <div class="flex-1 pl-4">
                    <p class="text-sm font-semibold text-primary">${(item.category || '').toUpperCase()} ${item.type}</p>
                    <h3 class="font-bold text-lg text-text-light dark:text-text-dark mt-1">${item.title}</h3>
                    <div class="flex justify-between text-sm mt-3">
                      <div>
                        <p class="text-text-muted-light dark:text-text-muted-dark">Start</p>
                        <p class="font-semibold text-text-light dark:text-text-dark">${item.start_time}</p>
                      </div>
                      <div>
                        <p class="text-text-muted-light dark:text-text-muted-dark">End</p>
                        <p class="font-semibold text-text-light dark:text-text-dark">${item.end_time}</p>
                      </div>
                    </div>
                    <div class="flex justify-between text-sm mt-2">
                      <div>
                        <p class="text-text-muted-light dark:text-text-muted-dark">${new Date(item.date).toLocaleDateString()}</p>
                        <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> ${item.location}</p>
                      </div>
                    </div>
                  </div>
                  <div class="border-l border-dashed border-border-light dark:border-border-dark pl-4 ml-4 flex flex-col items-center justify-center">
                    <p class="text-xs -rotate-90 whitespace-nowrap text-text-muted-light dark:text-text-muted-dark">Eligible for awards</p>
                    <button class="mt-6 px-3 py-1.5 text-xs rounded-lg bg-primary/10 text-primary hover:bg-primary/20 view-details">View Details</button>
                  </div>`;
                // click handler
                wrap.querySelector('.view-details').addEventListener('click', () => openDetailsModal(item.id));
                return wrap;
            };

            // Re-add placeholder card (with label as before revert)
            const buildPlaceholderCard = () => {
                const wrap = document.createElement('div');
                wrap.className = 'bg-card-light dark:bg-card-dark rounded-xl shadow-soft p-4 flex items-center opacity-70';
                wrap.innerHTML = `
                  <div class="w-24 h-24 bg-gray-200 dark:bg-white/10 rounded-lg"></div>
                  <div class="flex-1 pl-4">
                    <p class="text-sm font-semibold text-text-muted-light dark:text-text-muted-dark">—</p>
                    <h3 class="font-bold text-lg text-text-muted-light dark:text-text-muted-dark mt-1">No eligible event</h3>
                    <div class="flex justify-between text-sm mt-3">
                      <div>
                        <p class="text-text-muted-light dark:text-text-muted-dark">Start</p>
                        <p class="font-semibold text-text-muted-light dark:text-text-muted-dark">—</p>
                      </div>
                      <div>
                        <p class="text-text-muted-light dark:text-text-muted-dark">End</p>
                        <p class="font-semibold text-text-muted-light dark:text-text-muted-dark">—</p>
                      </div>
                    </div>
                    <div class="flex justify-between text-sm mt-2">
                      <div>
                        <p class="text-text-muted-light dark:text-text-muted-dark">—</p>
                        <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> —</p>
                      </div>
                    </div>
                  </div>
                  <div class="border-l border-dashed border-border-light dark:border-border-dark pl-4 ml-4 flex flex-col items-center justify-center">
                    <p class="text-xs -rotate-90 whitespace-nowrap text-text-muted-light dark:text-text-muted-dark">Eligible for awards</p>
                  </div>`;
                return wrap;
            };

            const loadEligible = async () => {
                if (!eligibleContainer) return;
                renderEligibleState('loading');
                try {
                    const res = await fetch('api/events.php?action=eligible', { cache: 'no-store' });
                    if (!res.ok) throw new Error('Network');
                    const data = await res.json();
                    eligibleContainer.innerHTML = '';
                    let items = Array.isArray(data) ? data.slice(0,2) : [];
                    if (items.length === 0) {
                        renderEligibleState('empty');
                        return;
                    }
                    items.forEach(item => eligibleContainer.appendChild(buildEligibleCard(item)));
                    if (items.length === 1) {
                        eligibleContainer.appendChild(buildPlaceholderCard());
                    }
                } catch (e) {
                    // On error, keep layout and show placeholders
                    eligibleContainer.innerHTML = '';
                    eligibleContainer.appendChild(buildPlaceholderCard());
                    eligibleContainer.appendChild(buildPlaceholderCard());
                }
            };

            // Details modal (simple)
            const ensureDetailsModal = () => {
                if (document.getElementById('eventDetailsModal')) return;
                const modal = document.createElement('div');
                modal.id = 'eventDetailsModal';
                modal.className = 'fixed inset-0 bg-black/30 hidden items-center justify-center z-[9999]';
                modal.innerHTML = `
                  <div class="bg-white dark:bg-card-dark rounded-2xl shadow-2xl w-full max-w-xl mx-4 max-h-[85vh] overflow-y-auto border border-border-light dark:border-border-dark">
                    <div class="p-4 border-b flex items-center justify-between">
                      <h3 class="text-lg font-semibold text-text-light dark:text-text-dark">Event Details</h3>
                      <button class="rounded-full p-2 hover:bg-gray-100 dark:hover:bg-white/10" id="closeEventDetails"><span class="material-symbols-outlined">close</span></button>
                    </div>
                    <div id="eventDetailsBody" class="p-4 grid gap-3 text-sm"></div>
                  </div>`;
                document.body.appendChild(modal);
                modal.querySelector('#closeEventDetails').addEventListener('click', () => closeDetailsModal());
                modal.addEventListener('click', (e)=>{ if(e.target===modal) closeDetailsModal(); });
            };
            const openDetailsModal = async (id) => {
                ensureDetailsModal();
                const modal = document.getElementById('eventDetailsModal');
                const body = document.getElementById('eventDetailsBody');
                body.innerHTML = '<div class="text-center text-text-muted-light dark:text-text-muted-dark">Loading...</div>';
                modal.classList.remove('hidden'); modal.classList.add('flex');
                try {
                    const res = await fetch(`api/events.php?id=${id}`);
                    const itm = await res.json();
                    body.innerHTML = `
                      <div class="flex items-start gap-4">
                        <img src="${itm.thumbnail_url || 'https://via.placeholder.com/120x80?text=img'}" class="w-28 h-20 object-cover rounded" alt="thumb"/>
                        <div>
                          <p class="text-xs font-semibold text-primary">${(itm.category||'').toUpperCase()} ${itm.type}</p>
                          <h4 class="text-lg font-bold">${itm.title}</h4>
                          <p class="text-xs text-text-muted-light dark:text-text-muted-dark"><span class="material-symbols-outlined text-xs align-middle">location_on</span> ${itm.location}</p>
                        </div>
                      </div>
                      <div class="grid grid-cols-2 gap-3">
                        <div><span class="text-text-muted-light dark:text-text-muted-dark">Start</span><p class="font-semibold">${itm.start_time}</p></div>
                        <div><span class="text-text-muted-light dark:text-text-muted-dark">End</span><p class="font-semibold">${itm.end_time}</p></div>
                        <div><span class="text-text-muted-light dark:text-text-muted-dark">Date</span><p class="font-semibold">${new Date(itm.date).toLocaleDateString()}</p></div>
                        <div><span class="text-text-muted-light dark:text-text-muted-dark">Eligible</span><p class="font-semibold">${itm.eligible_for_awards ? 'Yes' : 'No'}</p></div>
                      </div>
                      <div class="mt-2 text-xs text-text-muted-light dark:text-text-muted-dark">Awards eligibility details will appear on the Awards page.</div>`;
                } catch {
                    body.innerHTML = '<div class="text-center text-red-600 dark:text-red-400">Failed to load details.</div>';
                }
            };
            const closeDetailsModal = () => {
                const modal = document.getElementById('eventDetailsModal');
                if (modal) { modal.classList.add('hidden'); modal.classList.remove('flex'); }
            };

            // initial load and daily refresh at midnight local
            loadEligible();
            const scheduleRefresh = () => {
                const now = new Date();
                const midnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0,0,1);
                setTimeout(()=>{ loadEligible(); scheduleRefresh(); }, midnight - now);
            };
            scheduleRefresh();

            // Time range popover logic
            const timeBtn = document.getElementById('evTimeRangeBtn');
            const timePopover = document.getElementById('timeRangePopover');
            const timeOptions = document.getElementById('timeOptions');
            const tabStart = document.getElementById('timeTabStart');
            const tabEnd = document.getElementById('timeTabEnd');
            const timeText = document.getElementById('evTimeRangeText');
            let selecting = 'start';
            let startVal = '';
            let endVal = '';

            const buildTimes = () => {
                if (!timeOptions) return;
                const items = [];
                const pad = (n) => (n<10? '0'+n : ''+n);
                for (let h = 0; h < 24; h++) {
                    for (let m = 0; m < 60; m += 15) {
                        const dt = new Date(0,0,0,h,m);
                        const label = dt.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' });
                        items.push(label);
                    }
                }
                timeOptions.innerHTML = items.map(t => `<button class="w-full text-left px-3 py-2 hover:bg-gray-100 dark:hover:bg-white/10 rounded-md">${t}</button>`).join('');
                Array.from(timeOptions.children).forEach(btn => {
                    btn.addEventListener('click', () => {
                        const val = btn.textContent.trim();
                        if (selecting === 'start') {
                            startVal = val;
                            selecting = 'end';
                            tabStart.classList.remove('bg-primary/10','text-primary');
                            tabEnd.classList.add('bg-primary/10','text-primary');
                        } else {
                            endVal = val;
                            selecting = 'start';
                            tabEnd.classList.remove('bg-primary/10','text-primary');
                            tabStart.classList.add('bg-primary/10','text-primary');
                            timePopover.classList.add('hidden');
                        }
                        timeText.textContent = `${startVal || '--:-- --'} - ${endVal || '--:-- --'}`;
                    });
                });
            };
            if (timeBtn) {
                timeBtn.addEventListener('click', () => {
                    if (!timePopover) return;
                    timePopover.classList.toggle('hidden');
                    if (!timeOptions.innerHTML) buildTimes();
                });
            }
            tabStart && tabStart.addEventListener('click', () => {
                selecting = 'start';
                tabStart.classList.add('bg-primary/10','text-primary');
                tabEnd.classList.remove('bg-primary/10','text-primary');
            });
            tabEnd && tabEnd.addEventListener('click', () => {
                selecting = 'end';
                tabEnd.classList.add('bg-primary/10','text-primary');
                tabStart.classList.remove('bg-primary/10','text-primary');
            });
            document.addEventListener('click', (e) => {
                if (!timePopover || !timeBtn) return;
                const container = document.getElementById('timeRangeContainer');
                if (container && !container.contains(e.target)) {
                    timePopover.classList.add('hidden');
                }
            });

            // Location Autocomplete for Location Field
            let autocompleteService = null;
            let placesService = null;
            const locationInput = document.getElementById('evLocation');
            const locationSuggestions = document.getElementById('locationSuggestions');
            const suggestionsList = document.getElementById('suggestionsList');

            const loadGoogleMaps = () => {
                if (window.google && window.google.maps && window.google.maps.places) {
                    return Promise.resolve();
                }
                
                return new Promise((resolve, reject) => {
                    // Check if script already exists
                    if (document.querySelector('script[src*="maps.googleapis.com"]')) {
                        // Script exists but might not be loaded yet
                        const checkLoaded = () => {
                            if (window.google && window.google.maps && window.google.maps.places) {
                                resolve();
                            } else {
                                setTimeout(checkLoaded, 100);
                            }
                        };
                        checkLoaded();
                        return;
                    }
                    
                    const script = document.createElement('script');
                    script.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyD1p_x_nw6wT7_zUnILTuG17fHNOf0zFC4&libraries=places&loading=async&callback=initPlacesCallback';
                    script.async = true;
                    script.defer = true;
                    script.onerror = () => {
                        console.warn('Google Maps API failed to load. Please check your API key and internet connection.');
                        reject(new Error('Failed to load Google Maps API'));
                    };
                    
                    // Create callback function
                    window.initPlacesCallback = () => {
                        delete window.initPlacesCallback; // Clean up
                        resolve();
                    };
                    
                    document.head.appendChild(script);
                });
            };

            const showLocationSuggestions = async (query) => {
                if (!query.trim() || query.length < 2) {
                    locationSuggestions.classList.add('hidden');
                    return;
                }

                // Always show fallback suggestions first for better UX
                showFallbackSuggestions(query);

                // Try to load Google Places API in the background
                try {
                    await loadGoogleMaps();
                    
                    if (!autocompleteService) {
                        autocompleteService = new google.maps.places.AutocompleteService();
                    }

                    // Use the legacy API which is still working - restricted to Iloilo only
                    autocompleteService.getPlacePredictions({
                        input: query,
                        types: ['geocode', 'establishment'],
                        componentRestrictions: { country: 'ph' },
                        location: new google.maps.LatLng(10.7202, 122.5621), // Iloilo City coordinates
                        radius: 50000 // 50km radius around Iloilo
                    }, (predictions, status) => {
                        if (status === google.maps.places.PlacesServiceStatus.OK && predictions) {
                            // Filter predictions to only show Iloilo locations (strict filtering)
                            const iloiloPredictions = predictions.filter(prediction => {
                                const desc = prediction.description.toLowerCase();
                                return desc.includes('iloilo') && 
                                       !desc.includes('manila') &&
                                       !desc.includes('cebu') &&
                                       !desc.includes('davao') &&
                                       !desc.includes('baguio') &&
                                       !desc.includes('bacolod') &&
                                       !desc.includes('tacloban') &&
                                       !desc.includes('antique') &&
                                       !desc.includes('capiz') &&
                                       !desc.includes('aklan') &&
                                       !desc.includes('negros') &&
                                       !desc.includes('guimaras');
                            });
                            if (iloiloPredictions.length > 0) {
                                displaySuggestions(iloiloPredictions);
                            }
                            // If no Iloilo predictions, keep fallback suggestions
                        } else {
                            console.log('Places API status:', status);
                            // Keep fallback suggestions if API fails
                        }
                    });

                } catch (error) {
                    console.log('Places API failed:', error);
                    // Fallback suggestions are already shown
                }
            };

            const displaySuggestions = (predictions) => {
                suggestionsList.innerHTML = '';
                
                predictions.slice(0, 5).forEach((prediction, index) => {
                    const suggestionItem = document.createElement('div');
                    suggestionItem.className = 'flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 cursor-pointer transition-colors select-none';
                    suggestionItem.style.pointerEvents = 'auto';
                    suggestionItem.innerHTML = `
                        <span class="material-symbols-outlined text-text-muted-light dark:text-text-muted-dark text-sm">place</span>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-text-light dark:text-text-dark">${prediction.structured_formatting.main_text}</p>
                            <p class="text-xs text-text-muted-light dark:text-text-muted-dark">${prediction.structured_formatting.secondary_text}</p>
                        </div>
                    `;
                    
                    // Add click event with proper event handling
                    suggestionItem.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        locationInput.value = prediction.description;
                        locationSuggestions.classList.add('hidden');
                        // Trigger input event to update any other listeners
                        locationInput.dispatchEvent(new Event('input', { bubbles: true }));
                    });
                    
                    // Add mousedown event as backup
                    suggestionItem.addEventListener('mousedown', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    });
                    
                    suggestionsList.appendChild(suggestionItem);
                });
                
                locationSuggestions.classList.remove('hidden');
            };

            const showFallbackSuggestions = (query) => {
                console.log('Showing ILOILO-ONLY Events fallback suggestions for:', query); // Debug log
                
                // STRICT ILOILO-ONLY LOCATIONS - No other provinces or cities
                const commonLocations = [
                    // Iloilo City and Province - Main Areas
                    'Iloilo City, Philippines', 'Central Philippine University, Iloilo City, Philippines', 'University of the Philippines Visayas, Iloilo City, Philippines',
                    'West Visayas State University, Iloilo City, Philippines', 'University of San Agustin, Iloilo City, Philippines',
                    'St. Paul University Iloilo, Iloilo City, Philippines', 'Iloilo Science and Technology University, Iloilo City, Philippines',
                    
                    // Iloilo City Districts and Barangays
                    'Mandurriao, Iloilo City, Philippines', 'Molo, Iloilo City, Philippines', 'Jaro, Iloilo City, Philippines',
                    'La Paz, Iloilo City, Philippines', 'Lapuz, Iloilo City, Philippines', 'Arevalo, Iloilo City, Philippines',
                    'City Proper, Iloilo City, Philippines', 'Villa Arevalo, Iloilo City, Philippines',
                    
                    // Iloilo Province Municipalities
                    'Miagao, Iloilo, Philippines', 'San Joaquin, Iloilo, Philippines', 'Guimbal, Iloilo, Philippines',
                    'Tigbauan, Iloilo, Philippines', 'Oton, Iloilo, Philippines', 'Pavia, Iloilo, Philippines',
                    'Santa Barbara, Iloilo, Philippines', 'New Lucena, Iloilo, Philippines', 'Zarraga, Iloilo, Philippines',
                    'Leganes, Iloilo, Philippines', 'Dumangas, Iloilo, Philippines', 'Barotac Nuevo, Iloilo, Philippines',
                    'Barotac Viejo, Iloilo, Philippines', 'Anilao, Iloilo, Philippines', 'Banate, Iloilo, Philippines',
                    'Bingawan, Iloilo, Philippines', 'Cabatuan, Iloilo, Philippines', 'Calinog, Iloilo, Philippines',
                    'Carles, Iloilo, Philippines', 'Concepcion, Iloilo, Philippines', 'Dingle, Iloilo, Philippines',
                    'Dueñas, Iloilo, Philippines', 'Estancia, Iloilo, Philippines',
                    'Igbaras, Iloilo, Philippines', 'Janiuay, Iloilo, Philippines', 'Lambunao, Iloilo, Philippines',
                    'Maasin, Iloilo, Philippines', 'Passi City, Iloilo, Philippines', 'Pototan, Iloilo, Philippines',
                    'San Dionisio, Iloilo, Philippines', 'San Enrique, Iloilo, Philippines', 'San Miguel, Iloilo, Philippines',
                    'San Rafael, Iloilo, Philippines', 'Sara, Iloilo, Philippines', 'Tubungan, Iloilo, Philippines',
                    
                    // Popular Iloilo Landmarks and Places
                    'Iloilo Business Park, Mandurriao, Iloilo City, Philippines', 'SM City Iloilo, Mandurriao, Iloilo City, Philippines',
                    'Robinsons Place Iloilo, La Paz, Iloilo City, Philippines', 'Festive Walk Iloilo, Mandurriao, Iloilo City, Philippines',
                    'Iloilo Convention Center, Mandurriao, Iloilo City, Philippines', 'Iloilo International Airport, Cabatuan, Iloilo, Philippines',
                    'Miagao Church, Miagao, Iloilo, Philippines', 'Jaro Cathedral, Jaro, Iloilo City, Philippines',
                    'Molo Church, Molo, Iloilo City, Philippines', 'Casa Mariquit, Jaro, Iloilo City, Philippines',
                    'Iloilo Museum of Contemporary Art, Mandurriao, Iloilo City, Philippines', 'Plaza Libertad, City Proper, Iloilo City, Philippines',
                    'Esplanade, Iloilo City, Philippines', 'Iloilo River, Iloilo City, Philippines',
                    
                    // Iloilo Universities and Schools
                    'Central Philippine University, Jaro, Iloilo City, Philippines', 'University of the Philippines Visayas, Miagao, Iloilo, Philippines',
                    'West Visayas State University, La Paz, Iloilo City, Philippines', 'University of San Agustin, Jaro, Iloilo City, Philippines',
                    'St. Paul University Iloilo, Jaro, Iloilo City, Philippines', 'Iloilo Science and Technology University, La Paz, Iloilo City, Philippines',
                    'John B. Lacson Foundation Maritime University, Molo, Iloilo City, Philippines', 'Iloilo Doctors College, Mandurriao, Iloilo City, Philippines',
                    'Assumption Iloilo, Jaro, Iloilo City, Philippines', 'Ateneo de Iloilo, Mandurriao, Iloilo City, Philippines',
                    'Colegio de San Jose, Jaro, Iloilo City, Philippines', 'St. Therese MTC Colleges, La Paz, Iloilo City, Philippines',
                    
                    // Iloilo Hospitals and Medical Centers
                    'Iloilo Doctors Hospital, Mandurriao, Iloilo City, Philippines', 'West Visayas State University Medical Center, La Paz, Iloilo City, Philippines',
                    'St. Paul Hospital Iloilo, Jaro, Iloilo City, Philippines', 'Iloilo Mission Hospital, Jaro, Iloilo City, Philippines',
                    'The Medical City Iloilo, Mandurriao, Iloilo City, Philippines', 'QualiMed Hospital Iloilo, Mandurriao, Iloilo City, Philippines',
                    
                    // Iloilo Government Offices
                    'Iloilo Provincial Capitol, Iloilo City, Philippines', 'Iloilo City Hall, City Proper, Iloilo City, Philippines',
                    'Iloilo City Government Center, Mandurriao, Iloilo City, Philippines', 'Department of Trade and Industry Iloilo, Iloilo City, Philippines',
                    'Bureau of Internal Revenue Iloilo, Iloilo City, Philippines', 'Social Security System Iloilo, Iloilo City, Philippines',
                    
                    // Iloilo Shopping and Commercial Areas
                    'Gaisano City Iloilo, La Paz, Iloilo City, Philippines', 'Atrium Mall, Mandurriao, Iloilo City, Philippines',
                    'Plaza Libertad Commercial Complex, City Proper, Iloilo City, Philippines', 'Iloilo Central Market, City Proper, Iloilo City, Philippines',
                    'Iloilo Terminal Market, City Proper, Iloilo City, Philippines', 'Megaworld Iloilo Business Park, Mandurriao, Iloilo City, Philippines'
                ];

                const filtered = commonLocations.filter(location => 
                    location.toLowerCase().includes(query.toLowerCase())
                );

                if (filtered.length > 0) {
                    suggestionsList.innerHTML = '';
                    filtered.slice(0, 8).forEach(location => {
                        const suggestionItem = document.createElement('div');
                        suggestionItem.className = 'flex items-center gap-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-white/10 cursor-pointer transition-colors select-none';
                        suggestionItem.style.pointerEvents = 'auto';
                        suggestionItem.innerHTML = `
                            <span class="material-symbols-outlined text-text-muted-light dark:text-text-muted-dark text-sm">place</span>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-text-light dark:text-text-dark">${location}</p>
                                <p class="text-xs text-text-muted-light dark:text-text-muted-dark">Suggested location</p>
                            </div>
                        `;
                        
                        // Add click event with proper event handling
                        suggestionItem.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            locationInput.value = location;
                            locationSuggestions.classList.add('hidden');
                            // Trigger input event to update any other listeners
                            locationInput.dispatchEvent(new Event('input', { bubbles: true }));
                        });
                        
                        // Add mousedown event as backup
                        suggestionItem.addEventListener('mousedown', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                        });
                        
                        suggestionsList.appendChild(suggestionItem);
                    });
                    locationSuggestions.classList.remove('hidden');
                } else {
                    locationSuggestions.classList.add('hidden');
                }
            };

            // Add event listener to location input
            if (locationInput) {
                let timeoutId;
                locationInput.addEventListener('input', (e) => {
                    clearTimeout(timeoutId);
                    const query = e.target.value.trim();
                    
                    timeoutId = setTimeout(() => {
                        showLocationSuggestions(query);
                    }, 300); // Debounce for 300ms
                });

                // Hide suggestions when clicking outside
                document.addEventListener('click', (e) => {
                    if (!locationInput.contains(e.target) && !locationSuggestions.contains(e.target)) {
                        locationSuggestions.classList.add('hidden');
                    }
                });

                // Handle keyboard navigation
                locationInput.addEventListener('keydown', (e) => {
                    const suggestions = suggestionsList.querySelectorAll('div');
                    const activeSuggestion = suggestionsList.querySelector('[data-active="true"]');
                    
                    if (e.key === 'ArrowDown') {
                        e.preventDefault();
                        if (activeSuggestion) {
                            activeSuggestion.classList.remove('bg-primary/10');
                            activeSuggestion.removeAttribute('data-active');
                            const next = activeSuggestion.nextElementSibling;
                            if (next) {
                                next.classList.add('bg-primary/10');
                                next.setAttribute('data-active', 'true');
                            }
                        } else if (suggestions[0]) {
                            suggestions[0].classList.add('bg-primary/10');
                            suggestions[0].setAttribute('data-active', 'true');
                        }
                    } else if (e.key === 'ArrowUp') {
                        e.preventDefault();
                        if (activeSuggestion) {
                            activeSuggestion.classList.remove('bg-primary/10');
                            activeSuggestion.removeAttribute('data-active');
                            const prev = activeSuggestion.previousElementSibling;
                            if (prev) {
                                prev.classList.add('bg-primary/10');
                                prev.setAttribute('data-active', 'true');
                            }
                        }
                    } else if (e.key === 'Enter') {
                        e.preventDefault();
                        if (activeSuggestion) {
                            activeSuggestion.click();
                        }
                    } else if (e.key === 'Escape') {
                        locationSuggestions.classList.add('hidden');
                    }
                });
            }

            // Calendar Navigation Functionality
            window.currentDate = new Date();
            
            window.monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];

            window.updateCalendarTitle = function() {
                const month = window.monthNames[window.currentDate.getMonth()];
                const year = window.currentDate.getFullYear();
                const titleElement = document.getElementById('calendarTitle');
                if (titleElement) {
                    titleElement.textContent = `${month} ${year}`;
                }
            }

            window.renderCalendar = function() {
                const year = window.currentDate.getFullYear();
                const month = window.currentDate.getMonth();
                
                // Get first day of month and number of days
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startDay = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.

                // Get the calendar days container
                const calendarContainer = document.getElementById('calendarGrid');
                if (!calendarContainer) return;

                // Clear existing days (keep the first 7 header days: S M T W T F S)
                const allDays = calendarContainer.querySelectorAll('.py-2');
                for (let i = 7; i < allDays.length; i++) {
                    allDays[i].remove();
                }

                // Add empty cells for days before the first day of the month
                for (let i = 0; i < startDay; i++) {
                    const prevMonth = new Date(year, month, -startDay + i + 1);
                    const dayElement = document.createElement('div');
                    dayElement.className = 'py-2 text-gray-400 dark:text-gray-600 relative';
                    
                    // Check if this previous month day has events
                    const hasEvent = checkForEvents(prevMonth.getFullYear(), prevMonth.getMonth(), prevMonth.getDate());
                    
                    if (hasEvent) {
                        dayElement.innerHTML = `
                            <div class="relative inline-block w-full text-center">
                                <span class="text-gray-400 dark:text-gray-600">${prevMonth.getDate()}</span>
                                <div class="absolute -top-1 -right-1 w-1 h-1 bg-primary rounded-full"></div>
                            </div>
                        `;
                    } else {
                        dayElement.textContent = prevMonth.getDate();
                    }
                    
                    calendarContainer.appendChild(dayElement);
                }

                // Add days of the current month
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayElement = document.createElement('div');
                    dayElement.className = 'py-2 relative cursor-pointer hover:bg-gray-100 dark:hover:bg-white/10 rounded-lg transition-colors';
                    
                    // Check if this day has events
                    const hasEvent = checkForEvents(year, month, day);
                    const isToday = isCurrentDay(year, month, day);
                    
                    if (hasEvent) {
                        // Show day number with a dot indicator in upper right
                        dayElement.innerHTML = `
                            <div class="relative inline-block w-full text-center">
                                <span class="font-medium ${isToday ? 'text-white bg-primary rounded-full w-6 h-6 flex items-center justify-center mx-auto' : 'text-text-light dark:text-text-dark'}">${day}</span>
                                <div class="absolute -top-1 -right-1 w-1 h-1 bg-primary rounded-full"></div>
                            </div>
                        `;
                    } else {
                        // Regular day without events
                        if (isToday) {
                            dayElement.innerHTML = `<span class="font-medium text-white bg-primary rounded-full w-6 h-6 flex items-center justify-center mx-auto">${day}</span>`;
                        } else {
                            dayElement.textContent = day;
                        }
                    }
                    
                    calendarContainer.appendChild(dayElement);
                }

                // Add empty cells for days after the last day of the month
                const remainingCells = 42 - (startDay + daysInMonth); // 6 rows * 7 days = 42
                for (let i = 1; i <= remainingCells; i++) {
                    const nextMonth = new Date(year, month + 1, i);
                    const dayElement = document.createElement('div');
                    dayElement.className = 'py-2 text-gray-400 dark:text-gray-600 relative';
                    
                    // Check if this next month day has events
                    const hasEvent = checkForEvents(nextMonth.getFullYear(), nextMonth.getMonth(), nextMonth.getDate());
                    
                    if (hasEvent) {
                        dayElement.innerHTML = `
                            <div class="relative inline-block w-full text-center">
                                <span class="text-gray-400 dark:text-gray-600">${nextMonth.getDate()}</span>
                                <div class="absolute -top-1 -right-1 w-1 h-1 bg-primary rounded-full"></div>
                            </div>
                        `;
                    } else {
                        dayElement.textContent = nextMonth.getDate();
                    }
                    
                    calendarContainer.appendChild(dayElement);
                }
            }

            function checkForEvents(year, month, day) {
                // Check if this date has any scheduled events (including today)
                const savedEvents = JSON.parse(localStorage.getItem('upcomingEvents') || '[]');
                const checkDate = new Date(year, month, day);
                const dateString = checkDate.toISOString().split('T')[0]; // Format: YYYY-MM-DD
                
                // Check if there are events on this date (past, present, or future)
                const hasEvents = savedEvents.some(event => event.date === dateString);
                
                // Debug logging
                if (hasEvents) {
                    console.log(`Events found for ${dateString}:`, savedEvents.filter(event => event.date === dateString));
                }
                
                return hasEvents;
            }

            function isCurrentDay(year, month, day) {
                // Check if this date is today
                const today = new Date();
                const checkDate = new Date(year, month, day);
                
                return today.getFullYear() === year &&
                       today.getMonth() === month &&
                       today.getDate() === day;
            }


            // Event listeners for navigation buttons
            const prevBtn = document.getElementById('prevMonth');
            const nextBtn = document.getElementById('nextMonth');
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    window.currentDate.setMonth(window.currentDate.getMonth() - 1);
                    window.updateCalendarTitle();
                    window.renderCalendar();
                });
            }

            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    window.currentDate.setMonth(window.currentDate.getMonth() + 1);
                    window.updateCalendarTitle();
                    window.renderCalendar();
                });
            }

            // Initialize calendar immediately
            window.updateCalendarTitle();
            window.renderCalendar();
            
            // Add manual refresh function for debugging
            window.refreshCalendar = function() {
                console.log('Manual calendar refresh triggered');
                window.renderCalendar();
            };
            
            // Add function to check stored events
            window.checkStoredEvents = function() {
                const events = JSON.parse(localStorage.getItem('upcomingEvents') || '[]');
                console.log('All stored events:', events);
                events.forEach((event, index) => {
                    console.log(`Event ${index + 1}:`, {
                        title: event.title,
                        date: event.date,
                        id: event.id
                    });
                });
                return events;
            };
        });

        // Also initialize calendar when page loads (backup)
        window.addEventListener('load', () => {
            if (typeof window.updateCalendarTitle === 'function' && typeof window.renderCalendar === 'function') {
                window.updateCalendarTitle();
                window.renderCalendar();
            }
        });
    </script>

</body></html>




